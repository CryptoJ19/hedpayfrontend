(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{551:function(e,t,n){var content=n(569);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(15).default)("6033c5a0",content,!0,{sourceMap:!1})},552:function(e,t,n){var content=n(571);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(15).default)("217b2fad",content,!0,{sourceMap:!1})},553:function(e,t,n){var content=n(575);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(15).default)("4f0ddab2",content,!0,{sourceMap:!1})},562:function(e,t,n){"use strict";n(20);var r=n(1),o=(n(23),n(5)),c={name:"index",props:{label:{type:String,default:""},file:{default:null}},data:function(){return{name:this.label}},created:function(){this.file&&this.loadFileName()},filters:{truncate:function(e){return e.length>10?"".concat(e.slice(0,3),"...").concat(e.slice(-5)):e}},methods:{loadFileName:function(){var e=this,t=new FileReader;t.fileName=this.file.name,t.onload=function(t){e.name=t.target.fileName},t.readAsText(this.file)},downloadFile:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,link;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("user/".concat(o.FETCH_FILE),e.label);case 3:n=t.sent,r=window.URL.createObjectURL(new Blob([n])),(link=document.createElement("a")).href=r,link.setAttribute("download",e.label),document.body.appendChild(link),link.click(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.dir(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()}}},l=(n(568),n(6)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.label?r("button",{staticClass:"attachment-preview",on:{click:e.downloadFile}},[r("img",{staticClass:"ap__icon",attrs:{src:n(567),alt:"Attachment"}}),e._v(" "),r("span",{staticClass:"ap__label"},[e._v(e._s(e._f("truncate")(e.name)))])]):r("article",{staticClass:"attachment-preview"},[r("span",{staticClass:"ap__label"},[e._v(e._s(e._f("truncate")(e.name)))]),e._v(" "),e.file?r("button",{staticClass:"ap__button button__close",attrs:{type:"button"},on:{click:function(t){return e.$emit("delete",e.file)}}},[e._v("\n    X\n  ")]):e._e()])}),[],!1,null,"2184cb6f",null);t.a=component.exports},567:function(e,t,n){e.exports=n.p+"img/atta.2b9887b.svg"},568:function(e,t,n){"use strict";n(551)},569:function(e,t,n){(t=n(14)(!1)).push([e.i,".attachment-preview[data-v-2184cb6f]{font-size:14px;padding:15px;margin-right:10px}button.attachment-preview[data-v-2184cb6f]{background:#2dccd3;border-radius:8px;font-size:18px;line-height:1.16;letter-spacing:.06em;transition:all .3s;color:#fff}button.attachment-preview[data-v-2184cb6f]:hover{background:#27b4bd}button.attachment-preview[disabled][data-v-2184cb6f]{background-color:#596372;cursor:unset}@media screen and (max-width:1440px){button.attachment-preview[data-v-2184cb6f]{font-size:16px}}@media (max-width:425px){button.attachment-preview[data-v-2184cb6f]{font-size:14px}}",""]),e.exports=t},570:function(e,t,n){"use strict";n(552)},571:function(e,t,n){(t=n(14)(!1)).push([e.i,".message[data-v-6b647fb6]{padding:30px;border-radius:10px;border:1px solid #e5e5e5;display:flex;flex-direction:column;align-self:flex-start;font-size:14px}.message__header[data-v-6b647fb6]{font-size:16px}.message__body[data-v-6b647fb6],.message__header[data-v-6b647fb6]{margin-bottom:10px}.message__text[data-v-6b647fb6]{color:#052b43;opacity:.5;word-break:break-all}.message__meta[data-v-6b647fb6]{align-self:flex-end;font-size:13px;color:#052b43;opacity:.5}.message.message_sent[data-v-6b647fb6]{align-self:flex-end;background:linear-gradient(92.32deg,#2dccd3 -44.63%,#1494bc 138.12%);border-color:transparent;color:#fff}.message.message_sent .message__meta[data-v-6b647fb6],.message.message_sent .message__text[data-v-6b647fb6]{color:#fff;opacity:1}.attachments_panel[data-v-6b647fb6]{margin-top:10px}",""]),e.exports=t},572:function(e,t,n){e.exports=n.p+"img/attachment.2b9887b.svg"},573:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAyMCAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xOC40MjY3IDguMDk1TDEuNDI2NzQgMC4wOTQ5OTYyQzEuMjU1NTcgMC4wMTQwMTIzIDEuMDY0OTIgLTAuMDE2NjU2NyAwLjg3Njk4NiAwLjAwNjU2MzYyQzAuNjg5MDU4IDAuMDI5Nzg0IDAuNTExNTk4IDAuMTA1OTM3IDAuMzY1MjkxIDAuMjI2MTQ4QzAuMjE4OTg0IDAuMzQ2MzU5IDAuMTA5ODU1IDAuNTA1Njc2IDAuMDUwNjIzMiAwLjY4NTUzMUMtMC4wMDg2MDg5OSAwLjg2NTM4NiAtMC4wMTU1MDQ5IDEuMDU4MzcgMC4wMzA3Mzk0IDEuMjQyTDEuOTY5NzQgOUwwLjAzMDczOTQgMTYuNzU4Qy0wLjAxNTkzNzYgMTYuOTQxNyAtMC4wMDkzNDMyNSAxNy4xMzQ5IDAuMDQ5NzUxMSAxNy4zMTVDMC4xMDg4NDUgMTcuNDk1IDAuMjE3OTk2IDE3LjY1NDYgMC4zNjQ0MzYgMTcuNzc0OUMwLjUxMDg3NSAxNy44OTUyIDAuNjg4NTQ5IDE3Ljk3MTMgMC44NzY2NzIgMTcuOTk0NEMxLjA2NDggMTguMDE3NCAxLjI1NTU5IDE3Ljk4NjQgMS40MjY3NCAxNy45MDVMMTguNDI2NyA5LjkwNUMxOC41OTg1IDkuODI0MjQgMTguNzQzOCA5LjY5NjI1IDE4Ljg0NTUgOS41MzU5OUMxOC45NDczIDkuMzc1NzQgMTkuMDAxMyA5LjE4OTgzIDE5LjAwMTMgOUMxOS4wMDEzIDguODEwMTcgMTguOTQ3MyA4LjYyNDI2IDE4Ljg0NTUgOC40NjRDMTguNzQzOCA4LjMwMzc0IDE4LjU5ODUgOC4xNzU3NSAxOC40MjY3IDguMDk1Wk0yLjQ4MTc0IDE1LjE5N0wzLjMyMDc0IDExLjg0TDkuMDAwNzQgOUwzLjMyMDc0IDYuMTZMMi40ODE3NCAyLjgwM0wxNS42NTE3IDlMMi40ODE3NCAxNS4xOTdaIiBmaWxsPSJ3aGl0ZSIvPg0KPC9zdmc+DQo="},574:function(e,t,n){"use strict";n(553)},575:function(e,t,n){(t=n(14)(!1)).push([e.i,".attachments__panel[data-v-311e3220]{display:flex;flex-wrap:wrap}.message__form[data-v-311e3220]{width:100%;display:flex}.form__textarea[data-v-311e3220]{border:1px solid #eaeaea;border-radius:5px;padding:7px 16px;font-size:14px;line-height:1.16;letter-spacing:.06em;color:#052b43;height:40px;transition:border .3s;background-color:#f8f9f9;flex:1;margin-right:10px;min-height:36px;resize:vertical}.form__textarea[data-v-311e3220]:disabled{background:#f4f4f4}.form__textarea[data-v-311e3220]:focus{border:1px solid rgba(5,43,67,.34)}@media screen{.form__label[data-v-311e3220]{display:none}}.form__button[data-v-311e3220]{background:#2dccd3;border-radius:8px;font-size:18px;line-height:1.16;letter-spacing:.06em;transition:all .3s;color:#fff;width:36px;height:36px}.form__button[data-v-311e3220]:hover{background:#27b4bd}.form__button[disabled][data-v-311e3220]{background-color:#596372;cursor:unset}@media screen and (max-width:1440px){.form__button[data-v-311e3220]{font-size:16px}}@media (max-width:425px){.form__button[data-v-311e3220]{font-size:14px}}.message__send[data-v-311e3220]{margin-left:10px}.file-upload[data-v-311e3220]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;margin:0;cursor:pointer}.file-upload__input[data-v-311e3220]{display:none}.chat-form__counter[data-v-311e3220]{font-size:13px;letter-spacing:.06em;opacity:.3;margin-top:6px}.counter_invalid[data-v-311e3220]{color:#eb5757}",""]),e.exports=t},588:function(e,t,n){"use strict";var r={name:"chat-message",components:{previewAttachment:n(562).a},props:{message:{type:Object,required:!0}}},o=(n(570),n(6)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{staticClass:"message",class:{message_sent:"user"===e.message.sender.type}},[n("div",{staticClass:"message__header"},[e._v("\n    "+e._s(e.$t("chat."+e.message.sender.type))+"\n  ")]),e._v(" "),n("div",{staticClass:"message__body"},[n("div",{staticClass:"message__text"},[e._v("\n      "+e._s(e.message.message)+"\n    ")])]),e._v(" "),n("div",{staticClass:"message__meta"},[e._v("\n    "+e._s(e.$d(1e3*e.message.timestamp))+"\n  ")]),e._v(" "),e.message.attachments.length?n("div",{staticClass:"attachments_panel"},e._l(e.message.attachments,(function(e){return n("preview-attachment",{key:e.file,attrs:{label:e.file}})})),1):e._e()])}),[],!1,null,"6b647fb6",null);t.a=component.exports},589:function(e,t,n){"use strict";n(23),n(31),n(37),n(20);var r=n(1),o=n(5),c={name:"chat-form",components:{previewAttachment:n(562).a},data:function(){return{message:"",attachments:[],previews:[]}},methods:{sendMessage:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.message||e.attachments.length){t.next=2;break}return t.abrupt("return");case 2:return n=e.preparePayload(),t.prev=3,t.next=6,e.$store.dispatch("user/".concat(o.SEND_MESSAGE),n);case 6:e.resetForm(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.dir(t.t0);case 12:case"end":return t.stop()}}),t,null,[[3,9]])})))()},onEnter:function(e,t){e.ctrlKey||(e.preventDefault(),t(this.sendMessage()))},preparePayload:function(){var e=new FormData;return e.append("message",this.message),this.attachments.forEach((function(t){e.append("file",t)})),e},resetForm:function(){this.message="",this.attachments=[]},handleFileUpload:function(e){var t=Array.from(e.target.files);this.attachments=t},deleteAttachment:function(e){this.attachments=this.attachments.filter((function(t){return t.name!==e.name}))}}},l=(n(574),n(6)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("validation-observer",{attrs:{slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.handleSubmit;return[r("form",{staticClass:"chat__form",attrs:{action:""},on:{submit:function(t){return t.preventDefault(),o(e.sendMessage)}}},[r("div",{staticClass:"attachments__panel"},e._l(e.attachments,(function(t){return r("preview-attachment",{key:t.name,attrs:{file:t},on:{delete:e.deleteAttachment}})})),1),e._v(" "),r("div",{staticClass:"message__form"},[r("label",{staticClass:"form__label",attrs:{for:"send__message"}}),e._v(" "),r("validation-provider",{attrs:{rules:"max:1500",slim:""}},[r("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.message,expression:"message",modifiers:{trim:!0}}],staticClass:"form__textarea",attrs:{name:"",placeholder:e.$t("chat.message_placeholder"),id:"send__message",cols:"30",rows:"10"},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter(t,o)},input:function(t){t.target.composing||(e.message=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),e._v(" "),r("button",{staticClass:"form__button message__attachment",attrs:{type:"button"}},[r("label",{staticClass:"file-upload"},[r("img",{staticClass:"button__icon",attrs:{src:n(572),alt:"Attach"}}),e._v(" "),r("validation-provider",{attrs:{rules:"size:1048|ext:jpg,png,pdf,docx",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validate;return[r("input",{staticClass:"file-upload__input",attrs:{id:"file",type:"file",multiple:""},on:{change:function(t){e.handleFileUpload(t)||n(t)}}})]}}],null,!0)})],1)]),e._v(" "),r("button",{staticClass:"form__button message__send"},[r("img",{staticClass:"button__icon",attrs:{src:n(573),alt:"Send"}})])],1),e._v(" "),r("div",{staticClass:"chat-form__counter",class:{counter_invalid:e.message.length>1500}},[e._v("\n      "+e._s(e.$t("chat.symbols"))+" "+e._s(e.message.length+"/1500")+"\n    ")])])]}}])})}),[],!1,null,"311e3220",null);t.a=component.exports},661:function(e,t,n){"use strict";n.r(t);n(21),n(13),n(10),n(7),n(16),n(20);var r=n(1),o=n(3),c=n(588),l=n(589),d=n(30),m=n(5);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}t.default={layout:"app",middleware:"auth",components:{ChatForm:l.a,ChatMessage:c.a},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(d.b)({messages:"user/getMessages",connection:"connectionStatus"})),updated:function(){var e=this.$refs.chat;e&&e.scrollHeight!==this.scrollHeight&&(e.scrollTo(0,e.scrollHeight),this.scrollHeight=e.scrollHeight)},watch:{connection:{handler:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.connection){t.next=4;break}return t.next=3,e.$store.dispatch("user/".concat(m.GET_MESSAGES)).catch((function(e){console.dir(e)}));case 3:return t.abrupt("return",e.$store.dispatch("user/".concat(m.SUBSCRIBE_CHAT)));case 4:case"end":return t.stop()}}),t)})))()},immediate:!0}}}}}]);